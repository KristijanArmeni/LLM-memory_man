<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kristijan Armeni">
<meta name="author" content="Tal Linzen">
<meta name="author" content="Christopher Honey">

<title>Memory mechanisms in transformer language models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="manuscript_files/libs/clipboard/clipboard.min.js"></script>
<script src="manuscript_files/libs/quarto-html/quarto.js"></script>
<script src="manuscript_files/libs/quarto-html/popper.min.js"></script>
<script src="manuscript_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="manuscript_files/libs/quarto-html/anchor.min.js"></script>
<link href="manuscript_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="manuscript_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="manuscript_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="manuscript_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="manuscript_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Memory mechanisms in transformer language models</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Kristijan Armeni </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Johns Hopkins University, Department of Psychological and Brain Sciences
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Tal Linzen </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            New York University, Department of Linguistics
          </p>
        <p class="affiliation">
            New York University, Center for Data Science
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Christopher Honey </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Johns Hopkins University, Department of Psychological and Brain Sciences
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    TBA
  </div>
</div>

</header>

<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Flexibly maintaining and accessing recent text from short-term memory is a core computation in human <span class="citation" data-cites="elman_finding_1990">(<a href="#ref-elman_finding_1990" role="doc-biblioref">Elman 1990</a>)</span> Flexibly maintaining and accessing recent text from short-term memory is a core computation in human <span class="citation" data-cites="baddeley_working_2003-1 cowan_what_2008 oberauer_benchmarks_2018">(<a href="#ref-baddeley_working_2003-1" role="doc-biblioref">Baddeley 2003</a>; <a href="#ref-cowan_what_2008" role="doc-biblioref">Cowan 2008</a>; <a href="#ref-oberauer_benchmarks_2018" role="doc-biblioref">Oberauer et al. 2018</a>)</span> and artificial systems <span class="citation" data-cites="elman_finding_1990 nematzadeh_memory_2020">(<a href="#ref-elman_finding_1990" role="doc-biblioref">Elman 1990</a>; <a href="#ref-nematzadeh_memory_2020" role="doc-biblioref">Nematzadeh, Ruder, and Yogatama 2020</a>)</span> predicting and generating natural language. For example, when we are told ‘Your ticket number is 172’ and shortly after asked ‘What is your ticket number?’ we retrieve the number ‘172’ from short-term memory.</p>
<p>Contemporary transformer-based language models <span class="citation" data-cites="vaswani_attention_2017">(LM, <a href="#ref-vaswani_attention_2017" role="doc-biblioref">Vaswani et al. 2017</a>)</span> are currently the most successful algorithms at predicting words based on context and, seemingly, many natural language tasks that can be reformatted as text generation. A possible reason is that by weighing all context words in a task-relevant manner <span class="citation" data-cites="bahdanau_neural_2014">(attention, <a href="#ref-bahdanau_neural_2014" role="doc-biblioref">Bahdanau, Cho, and Bengio 2014</a>)</span>, transformers learn to retrieve the past tokens that are relevant in order to correctly predict upcoming words, a kind of short-term memory retrieval. For example, the ability to solve tasks by completing text prompts containing instructions and a small number of examples, without any explicit parameter updates, (in-context learning, see <span class="citation" data-cites="liu_pre-train_2021">Liu et al. (<a href="#ref-liu_pre-train_2021" role="doc-biblioref">2021</a>)</span>, for review) suggests that transformer LMs do so by retrieving instructions and relevant examples from short-term memory.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys<span class="op">;</span> sys.path.append(<span class="st">"/users/kriarm/project/lm-mem/code/"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wm_suite.viz.ablation <span class="im">import</span> fig_attn</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> paths <span class="im">import</span> get_paths</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>cfg <span class="op">=</span> get_paths()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> fig_attn.main([<span class="st">"--which"</span>, <span class="st">"main_fig"</span>, <span class="st">"--datadir"</span>, cfg.data])<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Found /users/kriarm/project/lm-mem/code/pathconfig.yaml
Using /users/kriarm/project/lm-mem/data as data directory
Summing attn weights over early tokens: [14 16 18]
Summing attn weights over late tokens: [44 43 42]
Finding top-20 attn heads across sequence positions [13]
Found 3 heads with top-20 attn scores and attention score &gt; 0.2.
Finding top-20 attn heads across sequence positions [14, 16, 18]
Found 20 heads with top-20 attn scores and attention score &gt; 0.2.
Finding top-20 attn heads across sequence positions [44, 43, 42]
Found 20 heads with top-20 attn scores and attention score &gt; 0.2.
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI
findfont: Generic family 'sans-serif' not found because none of the following families were found: Segoe UI</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading /users/kriarm/project/lm-mem/data/attention_weights_gpt2_colon-colon-p1.npz
Need 2 extra indices in layer 10</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="manuscript_files/figure-html/cell-2-output-3.png" width="1191" height="504"></p>
</div>
</div>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-baddeley_working_2003-1" class="csl-entry" role="listitem">
Baddeley, Alan. 2003. <span>“Working Memory and Language: An Overview.”</span> <em>Journal of Communication Disorders</em>, <span>ASHA</span> 2002, 36 (3): 189–208. <a href="https://doi.org/10.1016/S0021-9924(03)00019-4">https://doi.org/10.1016/S0021-9924(03)00019-4</a>.
</div>
<div id="ref-bahdanau_neural_2014" class="csl-entry" role="listitem">
Bahdanau, Dzmitry, Kyunghyun Cho, and Yoshua Bengio. 2014. <span>“Neural Machine Translation by Jointly Learning to Align and Translate.”</span> <em>CoRR</em> abs/1409.0473. <a href="http://arxiv.org/abs/1409.0473">http://arxiv.org/abs/1409.0473</a>.
</div>
<div id="ref-cowan_what_2008" class="csl-entry" role="listitem">
Cowan, Nelson. 2008. <span>“What Are the Differences Between Long-Term, Short-Term, and Working Memory?”</span> In <em>Progress in <span>Brain</span> <span>Research</span></em>, 169:323–38. Elsevier. <a href="https://doi.org/10.1016/S0079-6123(07)00020-9">https://doi.org/10.1016/S0079-6123(07)00020-9</a>.
</div>
<div id="ref-elman_finding_1990" class="csl-entry" role="listitem">
Elman, J. 1990. <span>“Finding Structure in Time.”</span> <em>Cognitive Science</em> 14 (2): 179–211. <a href="https://doi.org/10.1016/0364-0213(90)90002-E">https://doi.org/10.1016/0364-0213(90)90002-E</a>.
</div>
<div id="ref-liu_pre-train_2021" class="csl-entry" role="listitem">
Liu, Pengfei, Weizhe Yuan, Jinlan Fu, Zhengbao Jiang, Hiroaki Hayashi, and Graham Neubig. 2021. <span>“Pre-Train, Prompt, and Predict: <span>A</span> Systematic Survey of Prompting Methods in Natural Language Processing.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.2107.13586">https://doi.org/10.48550/arXiv.2107.13586</a>.
</div>
<div id="ref-nematzadeh_memory_2020" class="csl-entry" role="listitem">
Nematzadeh, A., Sebastian Ruder, and Dani Yogatama. 2020. <span>“On Memory in Human and Artificial Language Processing Systems.”</span> <a href="https:///paper/ON-MEMORY-IN-HUMAN-AND-ARTIFICIAL-LANGUAGE-SYSTEMS-Nematzadeh-Ruder/bcaf0a460e5a2f1ac48902071652d570023219f4">/paper/ON-MEMORY-IN-HUMAN-AND-ARTIFICIAL-LANGUAGE-SYSTEMS-Nematzadeh-Ruder/bcaf0a460e5a2f1ac48902071652d570023219f4</a>.
</div>
<div id="ref-oberauer_benchmarks_2018" class="csl-entry" role="listitem">
Oberauer, Klaus, Stephan Lewandowsky, Edward Awh, Gordon D. A. Brown, Andrew Conway, Nelson Cowan, Christopher Donkin, et al. 2018. <span>“Benchmarks for Models of Short-Term and Working Memory.”</span> <em>Psychological Bulletin</em> 144 (9): 885–958. <a href="https://doi.org/10.1037/bul0000153">https://doi.org/10.1037/bul0000153</a>.
</div>
<div id="ref-vaswani_attention_2017" class="csl-entry" role="listitem">
Vaswani, Ashish, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017. <span>“Attention Is All You Need.”</span> In <em>Proceedings of the 31st <span>International</span> <span>Conference</span> on <span>Neural</span> <span>Information</span> <span>Processing</span> <span>Systems</span></em>, 6000–6010. <span>NIPS</span>’17. Red Hook, NY, USA: Curran Associates Inc.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>